<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><style type=text/css>body{font-family:monospace}</style><title>Have a lot of if/else Statements Doing Similar Things? Use an Abstract Factory!</title><link rel=stylesheet href=/css/style.css></head><body><header>=======================<br>== <a href=https://jacobhell.github.io/>Jacob Hell's Blog</a> ==<br>=======================<div style=float:right></div><br><p><nav><a href=/><b>Start</b></a>.
<a href=/posts/><b>Posts</b></a>.
<a href=/categories/><b>Categories</b></a>.
<a href=/tags/><b>Tags</b></a>.
<a href=/index.xml><b>Feed</b></a>.</nav></p></header><main><article><h1>Have a lot of if/else Statements Doing Similar Things? Use an Abstract Factory!</h1><b><time>19.03.2020 00:00</time></b>
<a href=/tags/java>java</a>
<a href=/tags/abstract-factory>abstract factory</a><div><p>When working on a legacy system, one of the more common problems I see is similar actions happening within if/else or control statements.</p><p>Take this code snippet for example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> LedgerEntry <span style=color:#a6e22e>getLedgerEntry</span><span style=color:#f92672>(</span>TransactionDetails details<span style=color:#f92672>)</span>
<span style=color:#f92672>{</span>
	LedgerEntry entry <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
	String transactionType <span style=color:#f92672>=</span> details<span style=color:#f92672>.</span><span style=color:#a6e22e>getTransactionType</span><span style=color:#f92672>();</span>
	<span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>transactionType<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;check&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
		entry <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CheckEntry<span style=color:#f92672>();</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setCheckType</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;check&#34;</span><span style=color:#f92672>);</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setCheckPurchaser</span><span style=color:#f92672>(</span>details<span style=color:#f92672>.</span><span style=color:#a6e22e>getPurchaser</span><span style=color:#f92672>());</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setCheckDate</span><span style=color:#f92672>(</span>details<span style=color:#f92672>.</span><span style=color:#a6e22e>getDate</span><span style=color:#f92672>());</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setRoutingNumber</span><span style=color:#f92672>(</span>details<span style=color:#f92672>.</span><span style=color:#a6e22e>getRoutingNumber</span><span style=color:#f92672>());</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setAccountNumber</span><span style=color:#f92672>(</span>details<span style=color:#f92672>.</span><span style=color:#a6e22e>getAccountNumber</span><span style=color:#f92672>());</span>
	<span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>transactionType<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;creditcard&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
		entry <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CreditCardLedgerEntry<span style=color:#f92672>();</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setType</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;creditcard&#34;</span><span style=color:#f92672>);</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setCreditCardPurchaser</span><span style=color:#f92672>(</span>details<span style=color:#f92672>.</span><span style=color:#a6e22e>getPurchaser</span><span style=color:#f92672>());</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setCreditCardDate</span><span style=color:#f92672>(</span>details<span style=color:#f92672>.</span><span style=color:#a6e22e>getDate</span><span style=color:#f92672>());</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setCreditCardNumber</span><span style=color:#f92672>(</span>details<span style=color:#f92672>.</span><span style=color:#a6e22e>getCreditCardNumber</span><span style=color:#f92672>());</span>
	<span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>transactionType<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;cash&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
		entry <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CashEntry<span style=color:#f92672>();</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setType</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;cash&#34;</span><span style=color:#f92672>);</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setCashPurchaser</span><span style=color:#f92672>(</span>details<span style=color:#f92672>.</span><span style=color:#a6e22e>getPurchaser</span><span style=color:#f92672>());</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setCashDate</span><span style=color:#f92672>(</span>details<span style=color:#f92672>.</span><span style=color:#a6e22e>getDate</span><span style=color:#f92672>());</span>
	<span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>transactionType<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;crypto&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
		entry <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CryptoEntry<span style=color:#f92672>();</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setType</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;crypto&#34;</span><span style=color:#f92672>);</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setCryptoPurchaser</span><span style=color:#f92672>(</span>details<span style=color:#f92672>.</span><span style=color:#a6e22e>getPurchaser</span><span style=color:#f92672>());</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setCryptoDate</span><span style=color:#f92672>(</span>details<span style=color:#f92672>.</span><span style=color:#a6e22e>getDate</span><span style=color:#f92672>());</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setCyrptoPublicKey</span><span style=color:#f92672>(</span>details<span style=color:#f92672>.</span><span style=color:#a6e22e>getPublicKey</span><span style=color:#f92672>());</span>
	<span style=color:#f92672>}</span>
	

	<span style=color:#66d9ef>return</span> entry<span style=color:#f92672>;</span>

<span style=color:#f92672>}</span>
</code></pre></div><p>Let&rsquo;s say that this snippet is from a larger accounting program that will save financial records to a database.</p><p>This method is doing the following:</p><ol><li>Determining what type of transaction occurred based on the transaction type</li><li>Creating a concrete instance of the <code>LedgerEntry</code> abstract class</li><li>Returning this entry</li></ol><p>This method probably works fine, but what if we needed to do something for both cash and cryptocurrency transactions:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> LedgerEntry <span style=color:#a6e22e>getLedgerEntry</span><span style=color:#f92672>(</span>TransactionDetails details<span style=color:#f92672>)</span>
<span style=color:#f92672>{</span>
	<span style=color:#75715e>// previous code
</span><span style=color:#75715e></span>	

	<span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>transactionType<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;cash&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>||</span> transactionType<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;crypto&#34;</span><span style=color:#f92672>))</span>
	<span style=color:#f92672>{</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setAlertFBIAndPresidentOfUSA</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
	<span style=color:#f92672>}</span>
	<span style=color:#66d9ef>return</span> entry<span style=color:#f92672>;</span>

<span style=color:#f92672>}</span>
</code></pre></div><p>And what if further we needed to do something special to other transaction types? This could get complicated fast.</p><p>My go to solution for problems such as this to use the <strong>Abstract Factory Pattern</strong>. This is one of the patterns found in the famous book: <a href=https://www.amazon.com/Design-Patterns-Object-Oriented-Addison-Wesley-Professional-ebook/dp/B000SEIBB8>Design Patterns: Elements of Reusable Object-Oriented Software</a>.</p><p>The Abstract Factory Pattern relies on the client creating a <strong>Factory</strong> and then calling the abstract method <strong>create</strong>.</p><p>The nice thing about this is the client doesn&rsquo;t have to know about the inner workings of each create method.</p><p>Let&rsquo;s see what this method looks like after using the Abstract Factory Pattern:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> LedgerEntry <span style=color:#a6e22e>getLedgerEntry</span><span style=color:#f92672>(</span>TransactionDetails details<span style=color:#f92672>)</span>
<span style=color:#f92672>{</span>
	AbstractLedgerFactory ledgerFactory <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
	String transactionType <span style=color:#f92672>=</span> details<span style=color:#f92672>.</span><span style=color:#a6e22e>getTransactionType</span><span style=color:#f92672>();</span>
	<span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>transactionType<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;check&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
		ledgerFactory <span style=color:#f92672>=</span>  <span style=color:#66d9ef>new</span> CheckLedgerFactory<span style=color:#f92672>();</span>
	<span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>transactionType<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;creditcard&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
		ledgerFactory <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CreditCardLedgerFactory<span style=color:#f92672>();</span>
	<span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>transactionType<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;cash&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
		ledgerFactory <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CashLedgerFactory<span style=color:#f92672>();</span>
	<span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>transactionType<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;crypto&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
		ledgerFactory <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CryptoLedgerFactory<span style=color:#f92672>();</span>
	<span style=color:#f92672>}</span>
	

	<span style=color:#66d9ef>return</span> ledgerFactory<span style=color:#f92672>.</span><span style=color:#a6e22e>create</span><span style=color:#f92672>(</span>details<span style=color:#f92672>);</span>

<span style=color:#f92672>}</span>
</code></pre></div><p>Much easier to read! And if more logic needs to happen for transaction types, it can be done in the concrete factory method.</p><p>Here is the <code>AbstractLedgerFactory</code> and <code>CryptoLedgerFactory</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AbstractLedgerFactory</span>
<span style=color:#f92672>{</span>
	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> LedgerEntry <span style=color:#a6e22e>create</span><span style=color:#f92672>(</span>TransactionDetails details<span style=color:#f92672>);</span>
<span style=color:#f92672>}</span>
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CryptoLedgerFactory</span> <span style=color:#66d9ef>extends</span> AbstractLedgerFactory
<span style=color:#f92672>{</span>
	<span style=color:#a6e22e>@Override</span>
	<span style=color:#66d9ef>public</span> LedgerEntry <span style=color:#a6e22e>create</span><span style=color:#f92672>(</span>TransactionDetails details<span style=color:#f92672>)</span>
	<span style=color:#f92672>{</span>
		LedgerEntry entry <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CryptoEntry<span style=color:#f92672>();</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setType</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;crypto&#34;</span><span style=color:#f92672>);</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setCryptoPurchaser</span><span style=color:#f92672>(</span>details<span style=color:#f92672>.</span><span style=color:#a6e22e>getPurchaser</span><span style=color:#f92672>());</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setCryptoDate</span><span style=color:#f92672>(</span>details<span style=color:#f92672>.</span><span style=color:#a6e22e>getDate</span><span style=color:#f92672>());</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setCyrptoPublicKey</span><span style=color:#f92672>(</span>details<span style=color:#f92672>.</span><span style=color:#a6e22e>getPublicKey</span><span style=color:#f92672>());</span>
		entry<span style=color:#f92672>.</span><span style=color:#a6e22e>setAlertFBIAndPresidentOfUSA</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
		

		<span style=color:#66d9ef>return</span> entry<span style=color:#f92672>;</span>
	<span style=color:#f92672>}</span>

<span style=color:#f92672>}</span>
</code></pre></div></div></article></main><aside><div><div><h3>LATEST POSTS</h3></div><div><ul><li><a href=/post/5-17-21/>5-17-2021</a></li><li><a href=/post/5-16-21/>5-16-2021</a></li><li><a href=/post/java-16/>What's New in Java 16</a></li><li><a href=/post/gaming-pc-under-250/>How to Build a Gaming PC Under $250</a></li><li><a href=/post/reliability-scalability-maintainability/>What Are Reliability, Scalability, and Maintainability in Distributed Systems?</a></li></ul></div></div></aside><footer><p>&copy; 2021 <a href=https://jacobhell.github.io/><b>Jacob Hell's Blog</b></a>.
<a href=https://github.com/jacobhell><b>Github</b></a>.
<a href=https://linkedin.com/in/jacobhell><b>LinkedIn</b></a>.</p></footer></body></html>